version: 1
mode: enforce
allow_tools:
  - web.search
  - fs.read

http:
  # Optional CSRF-style hardening for browser-initiated requests.
  # If set, requests that include an Origin header not present in this list are rejected (403).
  # Requests with no Origin header are allowed.
  origin_allowlist: ["http://localhost:3000"]
  # Optional explicit allowlist of headers to forward to the upstream request.
  # Notes:
  # - `Authorization` is forwarded regardless to support authenticated upstreams.
  # - `Accept` is forwarded only for SSE requests (`Accept: text/event-stream`).
  # - Avoid adding secret-bearing headers unless you intend to propagate them.
  forward_headers: ["Traceparent", "Tracestate", "Baggage", "X-Request-Id"]
  # Optional Prometheus text exposition endpoint at GET /metrics.
  # Defaults to false; enable explicitly if you want Prometheus scraping.
  prometheus_metrics: false

record:
  # Redaction is applied before writing NDJSON recordings.
  # Use this to avoid accidentally persisting secrets in record files.
  redact_keys: ["token", "access_token", "api_key", "authorization"]
  # Optional: regex match on JSON object keys.
  redact_key_regex: ["(?i)secret|password"]
  # Optional: rotate the record file to prevent unbounded growth.
  # When enabled, the active file is renamed to `path.1`, shifting older backups
  # up to `path.N`.
  max_bytes: 10485760 # 10 MiB
  max_files: 3

replay:
  # Match strategy for replay lookups: signature (default), method, or tool.
  match: signature

tools:
  web.search:
    schema:
      type: object
      properties:
        query:
          type: string
        max_results:
          type: integer
          minimum: 1
          maximum: 10
      required: [query]
      additionalProperties: false

  fs.read:
    schema:
      type: object
      properties:
        path:
          type: string
        max_bytes:
          type: integer
          minimum: 1
          maximum: 1048576
      required: [path]
      additionalProperties: false
