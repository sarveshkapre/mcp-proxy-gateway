version: 1
mode: enforce
allow_tools:
  - web.search
  - fs.read

record:
  # Redaction is applied before writing NDJSON recordings.
  # Use this to avoid accidentally persisting secrets in record files.
  redact_keys: ["token", "access_token", "api_key", "authorization"]
  # Optional: regex match on JSON object keys.
  redact_key_regex: ["(?i)secret|password"]

replay:
  # Match strategy for replay lookups: signature (default), method, or tool.
  match: signature

tools:
  web.search:
    schema:
      type: object
      properties:
        query:
          type: string
        max_results:
          type: integer
          minimum: 1
          maximum: 10
      required: [query]
      additionalProperties: false

  fs.read:
    schema:
      type: object
      properties:
        path:
          type: string
        max_bytes:
          type: integer
          minimum: 1
          maximum: 1048576
      required: [path]
      additionalProperties: false
